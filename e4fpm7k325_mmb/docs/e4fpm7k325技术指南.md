# E4FPM7K325技术指南
## 板卡简介
E4FPM7K325板卡是LAB5604工作室专为多媒体开发、软核验证设计的FPGA开发板，套件采用核心板（SoM）+底板的形式，其主要特点有：
1. 核心电源采用具备PMBUS功能的大电流高性能（>=50A）方案，满足最极端场景下的供电需求。
2. 所有IOBank电源均为PMBUS可编程的电源供电。
3. 以太网RGMII PHY、ULPI USBPHY、eMMC、QSPI flash等高速并行外设均为SoM集成，减少时序约束的工作量。
4. 底板所有电源都采用高性能电源方案，且整板由一颗板载控制器（ec，型号为STC32）控制上下电，提供ec程序源码供用户自行编辑。
## 上电、下电
和PC机主板的上电流程类似，E4FPM7K325采用ec控制上电时序，板卡的上电时序如下：
插入适配器->按下适配器旁边的开关，电源输入使能->3.3V待机电压->PSON按下后板卡上电->板卡完全上电

在第一次插入适配器时，为了减少大电容突然接入打火的风险，推荐将适配器旁边的电源总开关置于OFF状态。
### 上电
1. 确保电源总开关为OFF状态（可选，但是推荐置于OFF状态）。
2. 插入15-24V电源适配器。
3. 按下电源总开关。
4. 按下PSON，EC随即控制板卡上电，板卡供电正常后主板ec旁边的绿色指示灯亮。

### 电源故障指示

如果在板卡正常上电后，板子上任何一个dcdc的power good信号被拉低（表示有dcdc失效），此时ec会强制让系统下电，并且ec旁边的红色指示灯亮。
此时如果再次按下PSON按键，会清除故障指示灯并重新执行上电流程。

### 下电

在系统正常运行时，再次按下PSON即下电。

## 更新EC固件
⚠ 注意！烧录自己编写EC固件可能会引起板卡不可修复的故障，请再三确认板卡上电时序代码和引脚配置。


更新ec固件流程：
1. 整板下电，总开关置于OFF状态，拔下SoM。
2. 插入USB线。
3. 按下EC_PROG按键的同时打开总开关。
4. EC正常进入ISP模式，此时可以在计算机设备管理器中看到“USB-HID-WRITE”设备，使用STC-ISP即可更新固件。
### 工厂版（factory）固件
工厂版固件可以用于测试电源轨和烧录电源固件。
### 发布版（release）固件
在正式发售的板卡中均为发布版固件。
